# SG Farmers App - Complete AWS Architecture Diagram

```
                                    🌐 INTERNET (Global Users)
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    🔗 DNS & CDN LAYER                                                             │
│                                                                                                                     │
│  ┌─────────────────┐                                              ┌─────────────────────────────────────────┐    │
│  │   ROUTE 53      │ ──────── Health Checks ──────────────────── │         CLOUDFRONT CDN                  │    │
│  │                 │                                              │                                         │    │
│  │ • sg-farmers.com│                                              │ • 400+ Edge Locations                  │    │
│  │ • Health Checks │                                              │ • Static: S3 Origin                    │    │
│  │ • Failover      │                                              │ • Dynamic: ALB Origin                  │    │
│  │ • Geolocation   │                                              │ • Cache: 1yr/5min/24hr TTL             │    │
│  └─────────────────┘                                              └─────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                   🛡️ SECURITY LAYER                                                              │
│                                                                                                                     │
│  ┌─────────────────────────────────────────┐              ┌─────────────────────────────────────────────────┐    │
│  │            AWS WAF v2                   │              │         AWS CERTIFICATE MANAGER                 │    │
│  │                                         │              │                                                 │    │
│  │ • OWASP Top 10 Protection               │              │ • Wildcard SSL: *.sg-farmers.com               │    │
│  │ • Rate Limiting: 100 req/5min           │              │ • Auto-renewal: 60 days                        │    │
│  │ • Geo Blocking: SG + ASEAN              │              │ • RSA-2048 / ECDSA P-256                       │    │
│  │ • Bot Control & IP Reputation           │              │ • DNS Validation                               │    │
│  └─────────────────────────────────────────┘              └─────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              ⚖️ LOAD BALANCING & TRAFFIC MANAGEMENT                                              │
│                                                                                                                     │
│                              ┌─────────────────────────────────────────┐                                         │
│                              │      APPLICATION LOAD BALANCER          │                                         │
│                              │                                         │                                         │
│                              │ Target Groups:                          │                                         │
│                              │ ├── /api/farmers/* → Registration:3000  │                                         │
│                              │ ├── /api/search/*  → Search:3001        │                                         │
│                              │ ├── /api/chat/*    → Chat:3002          │                                         │
│                              │ └── /*             → Frontend:3003      │                                         │
│                              │                                         │                                         │
│                              │ Health Checks: /health (30s interval)   │                                         │
│                              │ Sticky Sessions: Cookie-based           │                                         │
│                              └─────────────────────────────────────────┘                                         │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    🌐 NETWORK INFRASTRUCTURE                                                      │
│                                                                                                                     │
│                                    VPC: 10.0.0.0/16 (eu-west-2)                                                  │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                    PUBLIC TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.1.0/24                                    AZ-2b: 10.0.2.0/24                                │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │  NAT Gateway    │                                   │  NAT Gateway    │                               │    │
│  │  │  Internet GW    │ ←──────── ALB ──────────────────→ │  Internet GW    │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
│                                           │                                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                   PRIVATE TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.10.0/24                                   AZ-2b: 10.0.20.0/24                               │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │  ECS Services   │                                   │  ECS Services   │                               │    │
│  │  │  (50% capacity) │                                   │  (50% capacity) │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
│                                           │                                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                  DATABASE TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.100.0/24                                  AZ-2b: 10.0.200.0/24                              │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │ RDS Primary     │ ←──── Multi-AZ Sync ────────────→ │ RDS Standby     │                               │    │
│  │  │ Redis Primary   │                                   │ Redis Replica   │                               │    │
│  │  │ OpenSearch      │                                   │ OpenSearch      │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
# SG Farmers App - Complete AWS Architecture Diagram

```
                                    🌐 INTERNET (Global Users)
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    🔗 DNS & CDN LAYER                                                             │
│                                                                                                                     │
│  ┌─────────────────┐                                              ┌─────────────────────────────────────────┐    │
│  │   ROUTE 53      │ ──────── Health Checks ──────────────────── │         CLOUDFRONT CDN                  │    │
│  │                 │                                              │                                         │    │
│  │ • sg-farmers.com│                                              │ • 400+ Edge Locations                  │    │
│  │ • Health Checks │                                              │ • Static: S3 Origin                    │    │
│  │ • Failover      │                                              │ • Dynamic: ALB Origin                  │    │
│  │ • Geolocation   │                                              │ • Cache: 1yr/5min/24hr TTL             │    │
│  └─────────────────┘                                              └─────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                   🛡️ SECURITY LAYER                                                              │
│                                                                                                                     │
│  ┌─────────────────────────────────────────┐              ┌─────────────────────────────────────────────────┐    │
│  │            AWS WAF v2                   │              │         AWS CERTIFICATE MANAGER                 │    │
│  │                                         │              │                                                 │    │
│  │ • OWASP Top 10 Protection               │              │ • Wildcard SSL: *.sg-farmers.com               │    │
│  │ • Rate Limiting: 100 req/5min           │              │ • Auto-renewal: 60 days                        │    │
│  │ • Geo Blocking: SG + ASEAN              │              │ • RSA-2048 / ECDSA P-256                       │    │
│  │ • Bot Control & IP Reputation           │              │ • DNS Validation                               │    │
│  └─────────────────────────────────────────┘              └─────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              ⚖️ LOAD BALANCING & TRAFFIC MANAGEMENT                                              │
│                                                                                                                     │
│                              ┌─────────────────────────────────────────┐                                         │
│                              │      APPLICATION LOAD BALANCER          │                                         │
│                              │                                         │                                         │
│                              │ Target Groups:                          │                                         │
│                              │ ├── /api/farmers/* → Registration:3000  │                                         │
│                              │ ├── /api/search/*  → Search:3001        │                                         │
│                              │ ├── /api/chat/*    → Chat:3002          │                                         │
│                              │ └── /*             → Frontend:3003      │                                         │
│                              │                                         │                                         │
│                              │ Health Checks: /health (30s interval)   │                                         │
│                              │ Sticky Sessions: Cookie-based           │                                         │
│                              └─────────────────────────────────────────┘                                         │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    🌐 NETWORK INFRASTRUCTURE                                                      │
│                                                                                                                     │
│                                    VPC: 10.0.0.0/16 (eu-west-2)                                                  │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                    PUBLIC TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.1.0/24                                    AZ-2b: 10.0.2.0/24                                │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │  NAT Gateway    │                                   │  NAT Gateway    │                               │    │
│  │  │  Internet GW    │ ←──────── ALB ──────────────────→ │  Internet GW    │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
│                                           │                                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                   PRIVATE TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.10.0/24                                   AZ-2b: 10.0.20.0/24                               │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │  ECS Services   │                                   │  ECS Services   │                               │    │
│  │  │  (50% capacity) │                                   │  (50% capacity) │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
│                                           │                                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                  DATABASE TIER                                                             │    │
│  │                                                                                                             │    │
│  │  AZ-2a: 10.0.100.0/24                                  AZ-2b: 10.0.200.0/24                              │    │
│  │  ┌─────────────────┐                                   ┌─────────────────┐                               │    │
│  │  │ RDS Primary     │ ←──── Multi-AZ Sync ────────────→ │ RDS Standby     │                               │    │
│  │  │ Redis Primary   │                                   │ Redis Replica   │                               │    │
│  │  │ OpenSearch      │                                   │ OpenSearch      │                               │    │
│  │  └─────────────────┘                                   └─────────────────┘                               │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                🐳 CONTAINER ORCHESTRATION                                                        │
│                                                                                                                     │
│                                    ECS FARGATE CLUSTER                                                            │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                              MICROSERVICES LAYER                                                           │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ Registration    │  │   Search API    │  │   Chat API      │  │   Frontend      │                      │    │
│  │  │ API Service     │  │   Service       │  │   Service       │  │   Service       │                      │    │
│  │  │                 │  │                 │  │                 │  │                 │                      │    │
│  │  │ Port: 3000      │  │ Port: 3001      │  │ Port: 3002      │  │ Port: 3003      │                      │    │
│  │  │ Tasks: 2-6      │  │ Tasks: 2-4      │  │ Tasks: 2-4      │  │ Tasks: 2-4      │                      │    │
│  │  │ CPU: 0.5 vCPU   │  │ CPU: 0.5 vCPU   │  │ CPU: 0.5 vCPU   │  │ CPU: 0.25 vCPU  │                      │    │
│  │  │ Memory: 1GB     │  │ Memory: 1GB     │  │ Memory: 1GB     │  │ Memory: 0.5GB   │                      │    │
│  │  │                 │  │                 │  │                 │  │                 │                      │    │
│  │  │ • Farmer Reg    │  │ • Elasticsearch │  │ • OpenAI GPT-4  │  │ • React 18      │                      │    │
│  │  │ • Grant Apps    │  │ • Redis Cache   │  │ • WebSocket     │  │ • Material-UI   │                      │    │
│  │  │ • JWT Auth      │  │ • Autocomplete  │  │ • Chat History  │  │ • TypeScript    │                      │    │
│  │  │ • File Upload   │  │ • Filtering     │  │ • Context Mgmt  │  │ • PWA Ready     │                      │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  │                                                                                                             │    │
│  │  Auto Scaling Policies:                                                                                    │    │
│  │  ├── CPU > 70% → Scale Out (+1 task)                                                                      │    │
│  │  ├── CPU < 30% → Scale In (-1 task)                                                                       │    │
│  │  ├── Memory > 80% → Scale Out                                                                              │    │
│  │  └── Request Count > 1000/min → Scale Out                                                                  │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                 💾 DATA STORAGE & MANAGEMENT                                                      │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                   DATABASE LAYER                                                           │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ RDS PostgreSQL  │  │ ElastiCache     │  │ OpenSearch      │  │ S3 Storage      │                      │    │
│  │  │                 │  │ Redis           │  │                 │  │                 │                      │    │
│  │  │ • Multi-AZ      │  │                 │  │ • Search Index  │  │ • Static Assets │                      │    │
│  │  │ • db.t3.medium  │  │ • cache.t3.micro│  │ • Autocomplete  │  │ • File Uploads  │                      │    │
│  │  │ • 100GB SSD     │  │ • 1GB Memory    │  │ • Analytics     │  │ • Backups       │                      │    │
│  │  │ • Auto Backup   │  │ • Cluster Mode  │  │ • Logs          │  │ • CDN Origin    │                      │    │
│  │  │ • Encryption    │  │ • Auth Token    │  │ • t3.small      │  │ • Lifecycle     │                      │    │
│  │  │                 │  │                 │  │                 │  │                 │                      │    │
│  │  │ Tables:         │  │ Use Cases:      │  │ Indexes:        │  │ Buckets:        │                      │    │
│  │  │ • farmers       │  │ • Sessions      │  │ • farmers       │  │ • static-assets │                      │    │
│  │  │ • grants        │  │ • Cache         │  │ • grants        │  │ • uploads       │                      │    │
│  │  │ • applications  │  │ • Rate Limit    │  │ • chat_history  │  │ • backups       │                      │    │
│  │  │ • chat_history  │  │ • Pub/Sub       │  │ • documents     │  │ • logs          │                      │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              🔐 SECURITY & IDENTITY MANAGEMENT                                                   │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                 SECRETS & IAM                                                              │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ Secrets Manager │  │ IAM Roles       │  │ Security Groups │  │ VPC Endpoints   │                      │    │
│  │  │                 │  │                 │  │                 │  │                 │                      │    │
│  │  │ • DB Passwords  │  │ • ECS Task Role │  │ • ALB: 80,443   │  │ • S3 Gateway    │                      │    │
│  │  │ • API Keys      │  │ • ECS Exec Role │  │ • ECS: 3000-3003│  │ • Secrets Mgr   │                      │    │
│  │  │ • JWT Secrets   │  │ • Lambda Role   │  │ • RDS: 5432     │  │ • CloudWatch    │                      │    │
│  │  │ • OpenAI Key    │  │ • CloudWatch    │  │ • Redis: 6379   │  │ • ECR           │                      │    │
│  │  │ • Auto Rotation │  │ • S3 Access     │  │ • OpenSearch:443│  │                 │                      │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                               📊 MONITORING & OBSERVABILITY                                                      │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                              CLOUDWATCH ECOSYSTEM                                                          │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ CloudWatch      │  │ CloudWatch      │  │ X-Ray Tracing   │  │ CloudWatch      │                      │    │
│  │  │ Metrics         │  │ Logs            │  │                 │  │ Alarms          │                      │    │
│  │  │                 │  │                 │  │ • Request Flow  │  │                 │                      │    │
│  │  │ • ECS CPU/Mem   │  │ • Application   │  │ • Service Map   │  │ • Error Rate>5% │                      │    │
│  │  │ • ALB Requests  │  │ • Access Logs   │  │ • Latency       │  │ • CPU > 80%     │                      │    │
│  │  │ • RDS Perf      │  │ • Error Logs    │  │ • Dependencies  │  │ • Memory > 85%  │                      │    │
│  │  │ • Redis Hits    │  │ • Audit Logs    │  │ • Bottlenecks   │  │ • DB Conn > 80% │                      │    │
│  │  │ • Custom KPIs   │  │ • Security      │  │ • Error Root    │  │ • SNS → PagerDuty│                     │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                🌍 EXTERNAL INTEGRATIONS                                                          │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                              THIRD-PARTY SERVICES                                                          │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ OpenAI API      │  │ AWS SES         │  │ AWS SNS         │  │ Payment Gateway │                      │    │
│  │  │                 │  │                 │  │                 │  │                 │                      │    │
│  │  │ • GPT-4 Model   │  │ • Registration  │  │ • SMS OTP       │  │ • Grant Fees    │                      │    │
│  │  │ • 4K Context    │  │ • Notifications │  │ • Alerts        │  │ • Stripe/PayPal │                      │    │
│  │  │ • Rate Limits   │  │ • Password Reset│  │ • Status Updates│  │ • PCI Compliance│                      │    │
│  │  │ • Cost Opt      │  │ • Bulk Emails   │  │ • Multi-channel │  │ • Webhooks      │                      │    │
│  │  │ • Fallbacks     │  │ • Templates     │  │ • Delivery      │  │ • Refunds       │                      │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                              💰 COST OPTIMIZATION & BACKUP                                                       │
│                                                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────┐    │
│  │                                COST & RECOVERY                                                             │    │
│  │                                                                                                             │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                      │    │
│  │  │ Auto Scaling    │  │ Reserved        │  │ Automated       │  │ Disaster        │                      │    │
│  │  │                 │  │ Instances       │  │ Backups         │  │ Recovery        │                      │    │
│  │  │ • ECS: 2-10     │  │                 │  │                 │  │                 │                      │    │
│  │  │ • CPU Based     │  │ • RDS 1-year    │  │ • RDS Daily     │  │ • Multi-AZ      │                      │    │
│  │  │ • Memory Based  │  │ • 40% Savings   │  │ • 7-day Retain  │  │ • Cross-Region  │                      │    │
│  │  │ • Request Based │  │ • ElastiCache   │  │ • Point-in-Time │  │ • Auto Failover │                      │    │
│  │  │ • Schedule Based│  │ • OpenSearch    │  │ • S3 Lifecycle  │  │ • RTO: 15min    │                      │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘                      │    │
│  │                                                                                                             │    │
│  │  💰 Estimated Monthly Costs:                                                                               │    │
│  │  ├── Production: $531/month                                                                                │    │
│  │  ├── Development: $120/month                                                                               │    │
│  │  └── Total Annual: ~$7,800                                                                                 │    │
│  └─────────────────────────────────────────────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

## 🔄 Data Flow Summary

1. **User Request** → CloudFront → WAF → ALB → ECS Service
2. **Authentication** → JWT validation → Redis session check
3. **Database Operations** → Connection pool → RDS/Redis/OpenSearch
4. **AI Chat** → Context retrieval → OpenAI API → Response caching
5. **Search** → Query processing → Elasticsearch → Result caching
6. **Monitoring** → Metrics collection → CloudWatch → Alerting
7. **Scaling** → Threshold breach → Auto Scaling → New tasks
8. **Backup** → Scheduled snapshots → Cross-region replication

## 🚀 Deployment Pipeline

```
GitHub → Actions → ECR → ECS → Health Checks → Traffic Routing
   │         │       │     │         │              │
   └─ Code ──┴─ Build ┴─ Push ┴─ Deploy ┴─ Validate ──┴─ Live
```

**Total Infrastructure Components: 25+ AWS Services | High Availability | Auto-Scaling | Production-Ready**
```