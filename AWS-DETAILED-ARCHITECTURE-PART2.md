## ⚖️ **Layer 4: Load Balancing & Traffic Management**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        APPLICATION LOAD BALANCER                               │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      ALB Configuration                                 │   │
│  │                                                                         │   │
│  │  Network:                                                               │   │
│  │  ├── Scheme: Internet-facing                                           │   │
│  │  ├── IP Address Type: IPv4 + IPv6                                      │   │
│  │  ├── Subnets: Public subnets in 2 AZs                                  │   │
│  │  └── Security Groups: ALB-SG (80, 443 inbound)                         │   │
│  │                                                                         │   │
│  │  Listeners:                                                             │   │
│  │  ├── HTTP:80 → HTTPS:443 (301 Redirect)                                │   │
│  │  └── HTTPS:443 → Target Groups (Path-based)                            │   │
│  │                                                                         │   │
│  │  SSL Policy: ELBSecurityPolicy-TLS13-1-2-2021-06                      │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                        │
│                                        ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                       TARGET GROUPS                                    │   │
│  │                                                                         │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │
│  │  │Registration │ │   Search    │ │    Chat     │ │   Frontend  │      │   │
│  │  │    TG       │ │     TG      │ │     TG      │ │     TG      │      │   │
│  │  │   :3000     │ │   :3001     │ │   :3002     │ │    :80      │      │   │
│  │  │             │ │             │ │             │ │             │      │   │
│  │  │Health: /api │ │Health: /api │ │Health: /api │ │Health: /    │      │   │
│  │  │/farmers/    │ │/search/     │ │/chat/       │ │             │      │   │
│  │  │health       │ │health       │ │health       │ │             │      │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘      │   │
│  │                                                                         │   │
│  │  Routing Rules:                                                         │   │
│  │  ├── /api/farmers/* → Registration TG                                  │   │
│  │  ├── /api/search/* → Search TG                                         │   │
│  │  ├── /api/chat/* → Chat TG                                             │   │
│  │  ├── /socket.io/* → Chat TG (WebSocket)                                │   │
│  │  └── /* → Frontend TG (Default)                                        │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
```

## 🌐 **Layer 5: Network Infrastructure (VPC)**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                    VPC                                         │
│                              10.0.0.0/16                                       │
│                          (65,536 IP addresses)                                 │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          PUBLIC TIER                                   │   │
│  │                                                                         │   │
│  │  ┌─────────────────┐              ┌─────────────────┐                  │   │
│  │  │   PUBLIC-1A     │              │   PUBLIC-1B     │                  │   │
│  │  │  10.0.1.0/24    │              │  10.0.2.0/24    │                  │   │
│  │  │   (AZ-1a)       │              │   (AZ-1b)       │                  │   │
│  │  │                 │              │                 │                  │   │
│  │  │ ┌─────────────┐ │              │ ┌─────────────┐ │                  │   │
│  │  │ │ NAT Gateway │ │              │ │ NAT Gateway │ │                  │   │
│  │  │ │   (HA)      │ │              │ │   (HA)      │ │                  │   │
│  │  │ └─────────────┘ │              │ └─────────────┘ │                  │   │
│  │  │                 │              │                 │                  │   │
│  │  │ ┌─────────────┐ │              │ ┌─────────────┐ │                  │   │
│  │  │ │     ALB     │ │              │ │     ALB     │ │                  │   │
│  │  │ │  (Active)   │ │              │ │ (Standby)   │ │                  │   │
│  │  │ └─────────────┘ │              │ └─────────────┘ │                  │   │
│  │  └─────────────────┘              └─────────────────┘                  │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                        │                                        │
│                                        ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         PRIVATE TIER                                   │   │
│  │                                                                         │   │
│  │  ┌─────────────────┐              ┌─────────────────┐                  │   │
│  │  │   PRIVATE-1A    │              │   PRIVATE-1B    │                  │   │
│  │  │  10.0.10.0/24   │              │  10.0.11.0/24   │                  │   │
│  │  │   (AZ-1a)       │              │   (AZ-1b)       │                  │   │
│  │  │                 │              │                 │                  │   │
│  │  │ ECS Services:   │              │ ECS Services:   │                  │   │
│  │  │ ├─Registration  │              │ ├─Registration  │                  │   │
│  │  │ ├─Search        │              │ ├─Search        │                  │   │
│  │  │ └─Chat          │              │ └─Chat          │                  │   │
│  │  └─────────────────┘              └─────────────────┘                  │   │
│  │                                                                         │   │
│  │  ┌─────────────────┐              ┌─────────────────┐                  │   │
│  │  │   DATABASE-1A   │              │   DATABASE-1B   │                  │   │
│  │  │  10.0.20.0/24   │              │  10.0.21.0/24   │                  │   │
│  │  │   (AZ-1a)       │              │   (AZ-1b)       │                  │   │
│  │  │                 │              │                 │                  │   │
│  │  │ ├─RDS Primary   │              │ ├─RDS Standby   │                  │   │
│  │  │ ├─Redis Primary │              │ ├─Redis Replica │                  │   │
│  │  │ └─OpenSearch    │              │ └─OpenSearch    │                  │   │
│  │  └─────────────────┘              └─────────────────┘                  │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
```